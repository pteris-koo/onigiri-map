<!DOCTYPE html>
<html>
<head>
  <title>大阪のおにぎり屋MAP</title>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
     #map { height: 80vh; width: 100%; }
  </style>
</head>
<body>
  <h2>大阪のおにぎり屋MAP</h2>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://unpkg.com/papaparse@5.3.2/papaparse.min.js"></script>

  <script>
    const map = L.map('map').setView([34.69376333136194, 135.50219053509102], 10);

    var osmLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');
    var satelliteLayer = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}');

    osmLayer.addTo(map);

    L.control.layers({
      "OpenStreetMap": osmLayer,
      "航空写真": satelliteLayer
    }).addTo(map);

    const customIcon = L.icon({
      iconUrl: 'onigiri.png', // HTMLと同じフォルダに配置
      iconSize: [25, 25],
      iconAnchor: [20, 40],
      popupAnchor: [0, -40]
    });

    Papa.parse("onigiri_osaka.csv", {
      download: true,
      header: true,
      complete: function(results) {
        results.data.forEach(shop => {
          if (shop.lat && shop.lng) {
            L.marker([parseFloat(shop.lat), parseFloat(shop.lng)], { icon: customIcon })
              .addTo(map)
              .bindPopup(`<strong><a href="${shop.link}" target="_blank">${shop.name}</a></strong>`);
          }
        });
      }
    });
  </script>
</body>
</html>
